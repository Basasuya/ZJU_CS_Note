# 4.3 IPV4

#### 1.IPv4 分组格式

* 非常重要的一节，详情见p142，这个图肯定是要背的

> 首部长度5-8字节，IP首部3-4字节，片偏移7，8字节(其中前三位位标志位，00(DF)0(MF))，生存时间是第9个字节
>
> DF=0表示可以分片，MF=1表示有后续，可以参考p144

* 4首部长度，1总长度，8偏移量一定要记住
* DF，占第二位，MF占第三位

#### 2.IPV4 地址以及NAT

* 标准A,B,C网络同样要背，gg

> A(0) 1-126, B(10)128-191, C(110)192-223,D(1110)224-230

* 主机号日常减2(全0，全1是广播地址)，网络号至少减一(对于A组多减一个1，因为全0也不可以用)
* 127.xx.xx.xx座位环路自检
* LAN是外网，WAN是内网，对于WAN有专门的地址分配

> 10.0.0.0-10.255.255.255 172.16.0.0-172.31.255.255 192.168.0.0-192.168.255.255
>
> 多个WAN地址可以对应一个LAN地址(NAT)

#### 3.子网划分和子网掩码，CIDR

* 划分子网牵涉到子网掩码
* CIDR规范下对于网络号放宽了限制，但是对于主机号还是如此

> CIDR的作用是将小的网络汇聚为超网

* 0.0.0.0/0可以作为默认地址

#### 4.ARP协议，DCHP协议，ICMP协议

* ARP工作在网络层用语寻找IP地址对应的MAC帧，在IP数据传播过程中，IP地址一般是不变的，但是MAC帧是指向了下一个目的地的，所以需要寻找物理地址是什么
* DCHP，动态分配IP地址，基于UDP的运输层协议


* ICMP，终点不可达，源点抑制，时间超过，参数问题，重定向，IP层协议





***

* 目的主机用于重组原报文段
* 与分片和重组无关的字符是总长度
* IP分组可以在路径路由器当中分片，并在最后一条进行重组